<div class="bodycon pt-3 pb-3">
  <div class="container-fluid">

    <div class="row mb-3">
      <div class="col-md-3 text-right">
        <strong class="from">From &nbsp;</strong>
        <!--        <input id="datepicker" width="220"/>-->
        <input id="datepicker" width="220" placeholder="yyyy-mm-dd"
               [(ngModel)]="fromDate"
               name="dp" ngbDatepicker #d="ngbDatepicker">
        <button id="calender" (click)="d.toggle()" type="button"></button>
      </div>
      <div class="col-md-3 text-right">
        <strong class="from">To &nbsp;</strong>
        <input id="datepicker1" width="140" placeholder="yyyy-mm-dd"
               [(ngModel)]="toDate"
               name="dp" ngbDatepicker #d1="ngbDatepicker">
        <button id="calender1" (click)="d1.toggle()" type="button"></button>
      </div>
      <div class="col-md-3 text-right">
        <strong class="from">UpstreamStream Portal &nbsp;</strong>
        <select [(ngModel)]="upStreamPortal">
          <option *ngFor="let upstream of upStreamPortals;"
                  [value]="upstream?.portalID">{{upstream?.portalName}}</option>
        </select>
      </div>
<!--      <div class="col-md-2 text-right">-->
<!--        <strong class="from">DownstreamStream Portal &nbsp;</strong>-->
<!--        <select [(ngModel)]="downStreamPortal">-->
<!--          <option *ngFor="let downStream of downStreamPortals;"-->
<!--                  [value]="downStream?.portalID">{{downStream?.portalName}}</option>-->
<!--        </select>-->
<!--      </div>-->
      <div class="col-md-2 text-center">
        <button class="btn btn-primary loadSource" (click)="loadFromSource()">Load from source</button>
      </div>
    </div>
<!--    <div class="row mb-3">-->
<!--      <div class="col-4">-->
<!--        <select class="form-control" (change)="sortData($event.target.value)">-->
<!--          <option value="">Sort by</option>-->
<!--          <option value="id">Order Number</option>-->
<!--          <option value="price">Unit Price</option>-->
<!--          <option value="styleTitle">Style</option>-->
<!--          <option value="markup">Mark up</option>-->
<!--        </select>-->

<!--      </div>-->
<!--      <div class="col-md-3 ">-->
<!--        <input type="email" class="form-control mr-3 orderNumber" name="orderNumber" [(ngModel)]="orderNumber"-->
<!--               placeholder="Enter Order Number" id="email">-->
<!--        <button type="submit" *ngIf="!isSearched" class="btn btn-primary loadSource" (click)="filterByOrderNumber()">-->
<!--          Search-->
<!--        </button>-->
<!--        <button type="submit" *ngIf="isSearched" class="btn btn-primary loadSource" (click)="clearTableData()">Clear-->
<!--        </button>-->

<!--      </div>-->
<!--    </div>-->
    <div class="tableFixHead">
      <table>
        <thead>
        <tr>

          <th>S.No</th>
          <th>Select</th>
          <th>Style</th>
          <th>Product Details</th>

          <th>Product Type</th>

          <th>Collection</th>
          <th>Tags</th>
          <th>Unit Price
            <small>(Inc. shipping)</small></th>
          <th>Markup</th>

          <th>Sale Price</th>
          <th>Order
            Number
          </th>
          <th>Status</th>
          <th>Action</th>


        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let item of pagedItems;let i =index;">
          <td align="center" class="snoTd">{{i + 1}}</td>
          <td  align="center">
            <input type="checkbox" (click)="selectProduct($event,item)">
          </td>
          <td class="styleTd">
            <div class="styleImg">
              <img style="cursor:pointer;" (click)="details(item)"
                                       [src]="getImage(item?.photos)"/></div>
            <h6 style="cursor:pointer;" (click)="details(item?.id)" class="styleName">{{item?.title}}</h6>
          </td>
          <td class="pdTd" style="position: relative;">
            <!--            <p class="productDetailsText" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">A classic Chelsea boot shape gets a lifted edge with a chunky treaded rubber sole. Edgy, yet classic, the JESSIE is easy to slide into with elastic side panelling. Featuring a lightweight synthetic sole, it’s flexible and soft with wear. Set on our signature padded footbed, they’re a must for all day comfort.-->
            <!--              LabelUnspecified</p>-->
            <textarea style="width:100%;resize: none;font-size: 10px" rows=3 cols=22
                      [(ngModel)]="item.details">{{item?.details}}</textarea>
            <span data-toggle="modal" data-target="#myModal1" style="    position: absolute;cursor: pointer;
    bottom: 0;
    text-align: center;
    right: 10px;
    font-weight: bold;" (click)="selectDetIndex(item.productID)">...</span>
            <!--            <button class="readMoreBtn" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample"><span>...</span></button>-->
          </td>
          <td class="ptTd">
            <select class="form-control tableInput" [(ngModel)]="item.productType">
              <option>Select Type</option>
              <option *ngFor="let ptype of productTypes" [selected]="ptype === item?.productType">{{ptype}}</option>
            </select>
          </td>
          <td class="ptTd">
            <select class="form-control tableInput" [(ngModel)]="item.collections">
              <option>Select Collection</option>
              <option *ngFor="let collection of collections"
                      [selected]="collection === item?.collections">{{collection}}</option>
            </select>
          </td>
          <td class="ptTags">
            <div class="ribbonTd" *ngFor="let tag of item?.tags;let j =index;">
              <span style="cursor:pointer;position: absolute;
    left: 5px;" (click)="removeFromList(item.productID,tag)">X</span>
              <span>  {{tag}}</span>
            </div>
            <p *ngIf="getTagsLength(item?.tags) > 2">...</p>
            <div class="ribbonTd1">
              <span style="cursor:pointer;width: 18px;
    height: 18px;" data-toggle="modal" data-target="#myModal"
                    (click)="selectIndex(item.productID)">+</span>

            </div>
          </td>
          <td class="unitPrice"><p>$ {{item?.unitPriceWithShippingFee}} </p></td>
          <td><input type="text" class="form-control markupInput" [(ngModel)]="item.markup"></td>

          <td align="center"><p>$ {{getSalePrice(item?.unitPriceWithShippingFee, item?.markup)}} </p></td>
          <td><p>{{item?.orderNumber}}</p></td>
          <td><p>{{item?.downstreamStatus || 'N/A'}}</p></td>
          <td>
            <button (click)="saveData(item)" class="btn btn-primary loadSource">Save</button>
          </td>

        </tr>

        </tbody>
      </table>


    </div>


    <div class="tablePagination mt-3 pt-1">

        <strong class="from">DownstreamStream Portal &nbsp;</strong>
        <select style="margin-right:30px;" [(ngModel)]="downStreamPortal">
          <option *ngFor="let downStream of downStreamPortals;"
                  [value]="downStream?.portalID">{{downStream?.portalName}}</option>
        </select>


      <button class="btn btn-primary loadSource" (click)="uploadProducts()">Export to Destination</button>
      <ngb-pagination style="position: absolute;right: 0" [collectionSize]="pager.totalItems"
                      [pageSize]="pager.pageSize" [(page)]="pager.currentPage"
                      [maxSize]="pager.totalPages" [rotate]="true" (pageChange)="setPage(pager.currentPage)"
                      [boundaryLinks]="true"></ngb-pagination>
    </div>


  </div>
</div>
<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Add Tags</h4>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-6" >
            <input #customtag class="form-control" type="text" placeholder="Add new tag">

          </div>
          <div class="col-md-6" >
            <button class="btn btn-primary" (click)="addToTags(customtag)">Add</button>
          </div>
        </div>
        <div style="margin-top:20px;" class="row" *ngIf="isProdSelected">
          <div class="col-md-6" *ngFor="let tag of tags">
            <input type="checkbox" class="tags" [checked]="hasValue(tag)"
                   (click)="addToList($event.target.checked,tag)">
            <label style="margin-left: 10px !important; " >{{tag}}</label>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div style="float: left">
          <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="addListToProduct()">Add</button>
        </div>
        <div style="float: right">
          <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Modal -->
<div id="myModal1" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Product Details</h4>
      </div>
      <div class="modal-body">
        <textarea rows="10" cols="58" [(ngModel)]="selectedProdDetails"></textarea>
      </div>
      <div class="modal-footer">
        <div style="float: left">
          <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="updateProductDetails()">Add
          </button>
        </div>
        <div style="float: right">
          <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>

  </div>
</div>
<app-loading *ngIf="loading"></app-loading>
